# Лабораторная работа №4. Облачное хранилище данных. Amazon S3

### Цель работы: Научится работать с облачными хранилищами AWS
___
# Условия
1. Сервер frankfurt 
2. Форматы имен должны быть как в предыдушей лабораторной работе:
```
Публичный: cc-lab4-pub-kXX
Приватный: cc-lab4-priv-kXX
```
3. На локальном компьютере создать папку для дальнеиших работ, структура следующего содержания
```
s3-lab/
├── public/
│   ├── avatars/
│   │   ├── user1.jpg
│   │   └── user2.jpg
│   └── content/logo.png
├── private/
│   └── logs/
│       └── activity.csv
└── README.md
```

3.1 Создание папок
![createFolder1](https://i.imgur.com/IOJhpIA.png)
![createFolder1](https://i.imgur.com/rgmd9rM.png)
3.2 Перенос скачанных файлов
![moveData](https://i.imgur.com/JreR7Em.png)
___

## 1. Создание бакетов
**Бакеты** - это условные корзины или коробки которые будут содержать наши данные. В лабораторной необходимо реализовать 2 бакета приватный и публичный.
Бакеты должны быть созданы по условию:
```
Имя: cc-lab4-pub-kXX
Region: eu-central-1
Object Ownership: ACLs enabled (Can be configured using ACLs)
Block all public access: снять галочку (разрешить публичность)
```
1.1 Создание публичного бакета <br>
Задаются главные настройки (регион, название)
![genSettings](https://i.imgur.com/gUAh9lg.png)
Задаются настройки, что ACLs будет включен
![ownerSettings](https://i.imgur.com/fMr9rqa.png)
Убираем галочку, разрешаем публичность бакета, так же подтверждаем это действие
![blockPublic](https://i.imgur.com/Eji5dxb.png)
1.2 Создание приватного бакета <br>
![genSettings](https://i.imgur.com/WZEc2mC.png)
Остальные настройки, в приватном бакете будут по умолчанию.
![ownerSettings](https://i.imgur.com/IK2jymV.png)
![blockPublic](https://i.imgur.com/NvU1jXp.png)
**В обоих случаях после успешного создания появится уведомление:**
![success](https://i.imgur.com/jVvVpAY.png)
___
## 2. Загрузка ресурсов в бакет
Все загрузки производятся из публичного бакета, в данном случае надо зайти в созданый публичный бакет.
1. Заход в бакет - ```cc-lab4-pub-k7```
2. Далее нажать на upload - add folder это перенесет в наш бакет сразу всю папку.
![addedFile](https://i.imgur.com/YcLPTlp.png)
3. При загрузке **ГЛАВНОЕ РАЗРЕШИТЬ ПРАВА НА ЧТЕНИЕ**, иначе после перехода по ссылке ничего не сработает
![permise](https://i.imgur.com/sn0fAJ2.png)

## 2.1 Загрузка через ACL
1. Установка и настройка ACL, для этого нужно перейти на оффициальный источник AWS CLI, там будут несколько медотов установки AWS CLI
2. После установки и настройки необходимо прописать команду 
```
aws s3 cp s3-lab/public/avatars/user2.jpg s3://cc-lab4-pub-kXX/avatars/user2.jpg --acl public-read
```
Которая копирует файл из локального компьютера, сразу в бакет.
3. Такие же действия необходимо сделать и для приватного бакета и логотипа.
Переход по ссылке:
![photo1](https://i.imgur.com/pxnJ57y.png)
![photo2](https://i.imgur.com/UPXZpwv.png)
3.1 Загрузка папки content с логотипом
![logo](https://i.imgur.com/XHyaGTp.png)
3.2 Загрузка приватных фото
![private](https://i.imgur.com/odBnEd8.png)
Переход по ссылке:
![error](https://i.imgur.com/Z3b99R1.png)
## 2.2 Проверка путей
Выше указаны ссылки и пути, как видно в приватный бакет входа нет, что означает, что люди не смогут увидет от туда информацию.
___

## 3. Влючение версирования
Это поможет отследить версии файлов в бакете, очень удобно когда необходимо сделать например откат версии.
1. Для включения данного пункта надо зайти в публичный бакет, затем перейти во вкладку propierties
![](https://i.imgur.com/WzAtjZM.png)
2. Найти Bucket Versioning и нажать edit, в вкладке нажать enable (включено)
![](https://i.imgur.com/TK6Ezw9.png)
![](https://i.imgur.com/BJd5J1p.png)
3. Изменение файла и просмотр лога версии
![](https://i.imgur.com/pX9Q1g1.png)
___

## 4. Создание Lifecycle-правил для приватного бакета
1. Создание правил 
![](https://i.imgur.com/mnxhIwh.png)
2. Настройки правил
![](https://i.imgur.com/nJFFliw.png)
3. Успешное создание
![](https://i.imgur.com/9TOKIaA.png)
___
## 5. Создание статического сайта
Для этого необходимо создать бакет с тематическим названием в данной работе
cc-lab4-webkWW, как это сделано указано выше в **1 главе**
Тут лишь будет расписано, что делать для публичного сайта.
1. В proprieties надо разрешить static web hosting 
![](https://i.imgur.com/rDeL9CB.png)
2. Загрузка сайта в бакет
![](https://i.imgur.com/nPE617Q.png)
3. Переход по ссылке сайта
![](https://i.imgur.com/IfmJu9m.png)

## Контрольные вопросы
**Чем отличаются два способа управления доступом к бакетам в S3?**  
- Object Ownership Enforced: современный и рекомендуемый режим — отключает и игнорирует ACL, делает владелецом объектов аккаунт владельца бакета, управление доступом через IAM и bucket policies. Упрощает безопасность и предотвращает случайную публикацию.  
- ACL (Access Control List): устаревший, даёт гранулярные права на уровне объектов/аккаунтов (grantee/permission). Полезен для некоторых сценариев совместного доступа между аккаунтами, но сложнее и легче приводит к ошибкам; не рекомендуется для новых решений.

**Что означает опция “Block all public access” и зачем нужна данная настройка?**  
- Опция блокирует любые публичные настройки доступа на уровне аккаунта или бакета: предотвращает создание публичных ACL, публичных bucket policy и доступ по публичным ссылкам. Нужна для предотвращения случайной или нежелательной публичной публикации данных и для соблюдения принципа минимальных прав.

**Чем отличается ключ (object key) от имени файла?**  
- Ключ (object key) — это уникальный идентификатор объекта внутри бакета (может содержать «/» и выглядеть как путь). «Имя файла» — просто часть ключа (обычно последний сегмент). В S3 нет реальной иерархии файловой системы: «папки» — это префиксы в ключах.

**Что такое Storage Class в Amazon S3 и зачем они нужны?**  
- Storage Class — класс хранения, определяющий стоимость, доступность, время отклика и опции восстановления данных (например Standard, Intelligent‑Tiering, Standard‑IA, One Zone‑IA, Glacier варианты). Используются для оптимизации затрат и производительности: часто меняют класс по жизненному циклу объектов в зависимости от частоты доступа и требований к восстановлению.

# Статьи и источники
1. Скриншоты с работы -[тык](https://imgur.com/a/sZHZPlB)
